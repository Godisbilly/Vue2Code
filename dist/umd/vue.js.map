{"version":3,"file":"vue.js","sources":["../../src/observe/array.js","../../src/observe/index.js","../../src/state.js","../../src/compiler/parse.js","../../src/compiler/index.js","../../src/lifecycle.js","../../src/init.js","../../src/index.js"],"sourcesContent":["// 重写数组中的部分方法\n\n// 获取数组的原型\nlet oldArrayProto = Array.prototype\n\n// newArrayProto.__proto__ = oldArrayProto\nexport let newArrayProto = Object.create(oldArrayProto)\n\n// 变异方法（能修改原数组的方法）\nlet methods = ['push', 'pop', 'shift', 'unshift', 'reverse', 'sort', 'splice']\n\nmethods.forEach(method => {\n  newArrayProto[method] = function (...args) {\n    // 重写了数组方法，但是调用的时候还是调用的原来的方法\n    // 函数劫持\n    // 这个this指的是调用数组方法的那个数组\n    const result = oldArrayProto[method].call(this, ...args)\n    // 需要对新增的数据进行劫持\n    let inserted\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        inserted = args\n        break\n      case 'splice':\n        inserted = args.slice(2)\n        break\n      default:\n        break\n    }\n    if (inserted) {\n      let ob = this.__ob__\n      ob.observeArray(inserted)\n    }\n    // 这个result是数组的长度\n    return result\n  }\n})\n\n","import { newArrayProto } from './array.js'\nclass Observer {\n  constructor(data) {\n    // 给数组增加一个标识，如果数据上有__ob__属性，则说明这个属性被观测过\n    // data.__ob__ = this\n    Object.defineProperty(data, '__ob__', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: this\n    })\n    // Object.defineProperty只能劫持已经存在的数据，后增的、删除的属性都不能被检测到，因此Vue2中新增了一些API，如$set、$delete\n    // 遍历对象\n    if (Array.isArray(data)) {\n      // 重写数组中的方法\n      data.__proto__ = newArrayProto\n      // 对数组中的对象数据进行劫持\n      this.observeArray(data)\n      //需要保留数组原有的特性，并且重写部分方法\n    } else {\n      this.walk(data)\n    }\n  }\n\n  walk (data) {\n    // 遍历对象，对属性依次劫持\n    // 将数据属性转换为访问器属性\n    Object.keys(data).forEach(key => {\n      defineReactive(data, key, data[key])\n    })\n  }\n\n  observeArray (data) {\n    // 数组中的对象可以被检测到，不是对象属性的在进入到observe函数中就已经被return了\n    data.forEach(v => observe(v))\n  }\n}\n\nfunction defineReactive (target, key, value) {\n  // 如果属性值是一个对象，那么需要递归劫持\n  if (typeof value === 'object') {\n    observe(value)\n  }\n\n  // 重新定义属性，将数据属性转换为访问器属性\n  Object.defineProperty(target, key, {\n    get () {\n      return value\n    },\n    set (newValue) {\n      if (newValue === value) return\n      value = newValue\n    }\n  })\n}\n\n\n\nexport function observe (data) {\n  // 只对有效对象进行劫持\n  if (typeof data !== 'object' || data === null) return\n\n  // 如果一个对象被劫持过，那就不需要再被劫持了\n  // 判断一个对象是否被劫持过，可以增添一个实例，用实例来判断是否被劫持过\n  // 如果data上有__ob__属性，则说明这个对象已经被劫持过了\n  if (data.__ob__ instanceof Observer) return data.__ob__\n\n  return new Observer(data)\n}","import { observe } from './observe/index.js'\n\nexport function initState (vm) {\n  const opts = vm.$options\n  if (opts.data) {\n    initData(vm)\n  }\n}\n\nfunction proxy (vm, target, key) {\n  Object.defineProperty(vm, key, {\n    get () {\n      return vm[target][key]\n    },\n    set (newValue) {\n      if (newValue === vm[target][key]) return\n      vm[target][key] = newValue\n    }\n  })\n}\n\nfunction initData (vm) {\n  let data = vm.$options.data\n  // data可能是函数，也可能是对象\n  data = typeof data === 'function' ? data.call(vm) : data\n  // 对数据进行劫持，vue2里采用了Object.defineProperty\n  observe(data)\n  // 劫持之后，将data挂载到vm上\n  vm._data = data\n  // 将vm._data用vm来代理\n  for (let key in data) {\n    proxy(vm, '_data', key)\n  }\n}","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\nconst startTagOpen = new RegExp(`^<${qnameCapture}`)\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)\nconst attribute = /^\\s*([^\\s\"`<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|`([^`]*)`+|([^\\s\"`=<>`]+)))?/\nconst startTagClose = /^\\s*(\\/?)>/\n\nexport function parseHTML (html) {\n\n  const ELEMENT_TYPE = 1\n  const TEXT_TYPE = 3\n  const stack = [] // 存放元素\n  let currentParent // 指向栈中的最后一个元素\n  let root\n\n  function createASTElement (tag, attrs) {\n    return {\n      tag,\n      type: ELEMENT_TYPE,\n      children: [],\n      attrs,\n      parent: null\n    }\n  }\n\n  function start (tag, attrs) {\n    let node = createASTElement(tag, attrs)\n    // 如果根节点为空，则将当前节点设为树的根节点\n    if (!root) root = node\n    if (currentParent) {\n      node.parent = currentParent\n      currentParent.children.push(node)\n    }\n    stack.push(node)\n    currentParent = node\n  }\n\n  function chars (text) {\n    text = text.replace(/\\s/g, \"\")\n    text && currentParent.children.push({\n      type: TEXT_TYPE,\n      text,\n      parent: currentParent\n    })\n  }\n\n  function end (tag) {\n    let node = stack.pop()\n    if (node.tag !== tag) return\n    currentParent = stack[stack.length - 1]\n  }\n\n\n  function advance (n) {\n    html = html.substring(n)\n  }\n\n  function parseStartTag () {\n    const start = html.match(startTagOpen)\n    if (start) {\n      const match = {\n        tagName: start[1], // 标签名\n        attrs: []\n      }\n      advance(start[0].length)\n      // 如果不是开始标签的结束，就一直匹配下去\n      let attr, end\n      while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\n        advance(attr[0].length)\n        match.attrs.push({\n          name: attr[1],\n          value: attr[3] || attr[4] || attr[5]\n        })\n      }\n      if (end) {\n        advance(end[0].length)\n      }\n      return match\n    }\n    return false\n  }\n\n  // html最开始肯定是一个 <\n  while (html) {\n    // 如果indexOf中的索引是0，则说明是个标签\n    // textEnd为0，为开始标签\n    // textEnd大于0，为结束标签\n    let textEnd = html.indexOf('<')\n    if (textEnd == 0) {\n      // 开始标签的匹配\n      const startTagMatch = parseStartTag()\n      if (startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs)\n        continue\n      }\n\n      let endTagMatch = html.match(endTag)\n      if (endTagMatch) {\n        end(endTagMatch[1])\n        advance(endTagMatch[0].length)\n        continue\n      }\n    }\n\n    if (textEnd > 0) {\n      let text = html.substring(0, textEnd)\n      if (text) {\n        chars(text)\n        advance(text.length)\n      }\n    }\n  }\n  return root\n}","import { parseHTML } from './parse'\nfunction genProps (attrs) {\n  let str = ''\n  attrs.forEach(attr => {\n    if (attr.name === 'style') {\n      const obj = {}\n      attr.value.split(';').forEach(item => {\n        let [key, value] = item.split(':')\n        obj[key] = value\n      })\n      attr.value = obj\n    }\n    str += `${attr.name}:${JSON.stringify(attr.value)},`\n  })\n  return `{${str.slice(0, -1)}}`\n}\n\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\nfunction genChild (node) {\n  if (node.type === 1) {\n    return codegen(node)\n  } else {\n    if (!defaultTagRE.test(node.text)) {\n      return `_v(${JSON.stringify(node.text)})`\n    }\n    let tokens = []\n    let match\n    defaultTagRE.lastIndex = 0\n    let lastIndex = 0\n    while (match = defaultTagRE.exec(node.text)) {\n      let index = match.index // 匹配的位置\n      if (index > lastIndex) {\n        tokens.push(JSON.stringify(node.text.slice(lastIndex, index)))\n      }\n      tokens.push(`_s(${match[1].trim()})`)\n      lastIndex = index + match[0].length\n    }\n    if (lastIndex < node.text.length) {\n      tokens.push(JSON.stringify(node.text.slice(lastIndex)))\n    }\n    return `_v(${tokens.join('+')})`\n  }\n}\n\nfunction genChildren (children) {\n  if (children) {\n    return children.map(child => genChild(child)).join(',')\n  } else {\n    return children\n  }\n}\n\nfunction codegen (ast) {\n  let code = `_c(\n    '${ast.tag}',${ast.attrs.length > 0 ? genProps(ast.attrs) : null}${ast.children.length > 0 ? `,${genChildren(ast.children)}` : null})`\n  return code\n}\n\n// Vue3采用的不是正则表达式\n// 对模板进行编译处理\nexport function compileToFunction (template) {\n  // 对模板进行编译\n  // 将template转换成ast语法树\n  // 生成render方法（render方法执行后的返回结果就是虚拟DOM）\n  let ast = parseHTML(template)\n  let code = codegen(ast)\n  // 所有模版的实现原理都是with + new Function\n  code = `with(this){return ${code}}`\n  return new Function(code) // 根据代码生成render函数\n}","export function initLifeCycle (Vue) {\n\n  // 渲染虚拟DOM\n  Vue.prototype._render = function () {\n    console.log('render')\n  }\n\n  // 变成真实DOM\n  Vue.prototype._update = function () {\n    console.log('update')\n    const vm = this\n    return vm.$options.render.call(vm) // 通过ast语法转义后生成的render方法\n  }\n\n  Vue.prototype._c = function () {\n\n  }\n\n  Vue.prototype._v = function () {\n\n  }\n}\n\n\n\nexport function mountComponent (vm, el) {\n  // 调用render方法，产生虚拟节点 虚拟DOM\n  vm._render() // vm.$options.render() 虚拟节点\n  //根据虚拟DOM产生真实DOM\n  // 插入到el元素中\n}\n\n// Vue核心流程：\n// 1.创造了响应式数据\n// 2.模板转换成ast语法树\n// 3.将ast语法树转换成render函数\n// 4.后续每次数据更新可以只执行render函数，无须再次执行ast转化的过程\n// render函数会去产生虚拟节点（使用响应式数据），根据生成的虚拟节点创造真实的DOM","import { initState } from \"./state.js\"\nimport { compileToFunction } from \"./compiler/index.js\"\nimport { mountComponent } from \"./lifecycle.js\"\n\nexport function initMixin (Vue) {\n  // 初始化操作\n  Vue.prototype._init = function (options) {\n    // 先将options挂载到vue实例上\n    // 接下来就是处理options\n    const vm = this\n    vm.$options = options\n\n    // 初始化状态\n    initState(vm)\n\n\n    if (options.el) {\n      // 实现数据的挂载\n      vm.$mount(options.el)\n    }\n  }\n\n  Vue.prototype.$mount = function (el) {\n    const vm = this\n    const opts = vm.$options\n    if (!opts.render) {\n      // 先进行查找，有没有render函数，如果没有renderh函数，再看一下是否写了template，如果写了template，就用template，没有则用el获取template\n      let template\n      if (opts.template) {\n        template = opts.template\n      } else {\n        if (opts.el) {\n          const div = document.querySelector(el)\n          template = div.outerHTML\n        }\n      }\n      if (template) {\n        opts.render = compileToFunction(template)\n        // jsx最终会被编译成h('xxx')\n      }\n    } // if (typeof opts.render === 'function') opts.render()\n    // script标签引用的vue.global.js  这个编译过程是在浏览器中运行的\n    // runtime是不包含模板编译的，整个编译是打包的时候通过loader来转译.vue文件的，用runtime的时候不能用template\n    // 组件的挂载\n    mountComponent(vm, el)\n  }\n}","import { initMixin } from './init.js'\nimport { initLifeCycle } from './lifecycle.js'\n\nfunction Vue (options) {\n  this._init(options)\n}\n\ninitMixin(Vue)\ninitLifeCycle(Vue)\n\nexport default Vue"],"names":["oldArrayProto","Array","prototype","newArrayProto","Object","create","methods","forEach","method","args","result","call","inserted","slice","ob","__ob__","observeArray","Observer","data","defineProperty","enumerable","configurable","writable","value","isArray","__proto__","walk","keys","key","defineReactive","v","observe","target","get","set","newValue","initState","vm","opts","$options","initData","proxy","_data","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","ELEMENT_TYPE","TEXT_TYPE","stack","currentParent","root","createASTElement","tag","attrs","type","children","parent","start","node","push","chars","text","replace","end","pop","length","advance","n","substring","parseStartTag","match","tagName","attr","name","textEnd","indexOf","startTagMatch","endTagMatch","genProps","str","obj","split","item","JSON","stringify","defaultTagRE","genChild","codegen","test","tokens","lastIndex","exec","index","trim","join","genChildren","map","child","ast","code","compileToFunction","template","Function","initLifeCycle","Vue","_render","console","log","_update","render","_c","_v","mountComponent","el","initMixin","_init","options","$mount","div","document","querySelector","outerHTML"],"mappings":"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"}